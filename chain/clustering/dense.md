---
title: Voxel Clustering
description: Track + shower fragments
published: true
date: 2021-04-04T10:11:12.652Z
tags: 
editor: markdown
dateCreated: 2020-05-18T21:02:31.963Z
---


# Voxel Clustering

Voxel clustering refers to the task of clustering point cloud data into different particle IDs. 
Currently there are two neural-network based models for voxel clustering: SPICE, GraphSPICE, and Sparse Mask-RCNN. 

## 1. SPICE

### A. Description
![spice_architecture.png](/architectures/spice_architecture.png)

### B. Training/Testing

### C. Performance
#### PILArNet (w/o ghost points)
![f32d6_boxplot.png](/performance/f32d6_boxplot.png){.align-center}

#### ICARUS simulation (w/ ghost points)
From January 2021, by Laura
![spice_icarus.png](/performance/icarus/spice_icarus.png =500x){.align-center}

### D. Event displays

[event_test_25_cnn_clust_label_vs_pred.pdf](/event_displays/event_test_25_cnn_clust_label_vs_pred.pdf)




## 2. GraphSPICE


### A. Description

**GraphSPICE** is an enhancement of **SPICE** to explicitly use local geometric information during label generation. This is done by applying an edge classification loss to a k-nearest neighbor graph over the 3D voxel coordinates. During inference, the labels are generated by dropping edges with low probability scores and counting the remaining connected components. 

**GraphSPICE** models have two to three major components: 1) **Embedder**, 2) **Similarity Kernel**, and an optional 3) **VoxelGNN**.  is a trainable CNN-based coordinate transform that maps input voxels with respect to some similarity loss (ex. Vanilla **SPICE** is an example of an **embedder**). 

Since loss computations and label generation must be done in a per-event and per-semantic class basis, we implement a new data structure `ClusterGraphConstructor` parsing individual graphs conveniently (and avoid having to manually assign nodes and edges by slicing on `batch_id` and `semantic_id`, etc. 

### B. Training/Testing

### C. Performance

#### PILArNet (w/o ghost points)

### D. Examples